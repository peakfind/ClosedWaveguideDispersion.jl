<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Homogeneous case with Neumann boundary condition · ClosedWaveguideDispersion.jl</title><meta name="title" content="Homogeneous case with Neumann boundary condition · ClosedWaveguideDispersion.jl"/><meta property="og:title" content="Homogeneous case with Neumann boundary condition · ClosedWaveguideDispersion.jl"/><meta property="twitter:title" content="Homogeneous case with Neumann boundary condition · ClosedWaveguideDispersion.jl"/><meta name="description" content="Documentation for ClosedWaveguideDispersion.jl."/><meta property="og:description" content="Documentation for ClosedWaveguideDispersion.jl."/><meta property="twitter:description" content="Documentation for ClosedWaveguideDispersion.jl."/><meta property="og:url" content="https://peakfind.github.io/ClosedWaveguideDispersion.jl/homogeneous/"/><meta property="twitter:url" content="https://peakfind.github.io/ClosedWaveguideDispersion.jl/homogeneous/"/><link rel="canonical" href="https://peakfind.github.io/ClosedWaveguideDispersion.jl/homogeneous/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClosedWaveguideDispersion.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Homogeneous case with Neumann boundary condition</a><ul class="internal"><li><a class="tocitem" href="#Problem"><span>Problem</span></a></li><li><a class="tocitem" href="#Code"><span>Code</span></a></li><li><a class="tocitem" href="#Plain-code"><span>Plain code</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../dirichlet/">Homogeneous case with Dirichelt boundary condition</a></li><li><a class="tocitem" href="../zhang_case2/">Inhomogeneous case</a></li><li><a class="tocitem" href="../pa2/">PA-Two</a></li><li><a class="tocitem" href="../pa3/">PA-Three</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Homogeneous case with Neumann boundary condition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Homogeneous case with Neumann boundary condition</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/peakfind/ClosedWaveguideDispersion.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/peakfind/ClosedWaveguideDispersion.jl/blob/main/docs/src/homogeneous.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Homogeneous-case-with-Neumann-boundary-condition"><a class="docs-heading-anchor" href="#Homogeneous-case-with-Neumann-boundary-condition">Homogeneous case with Neumann boundary condition</a><a id="Homogeneous-case-with-Neumann-boundary-condition-1"></a><a class="docs-heading-anchor-permalink" href="#Homogeneous-case-with-Neumann-boundary-condition" title="Permalink"></a></h1><h2 id="Problem"><a class="docs-heading-anchor" href="#Problem">Problem</a><a id="Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Problem" title="Permalink"></a></h2><p>This problem in given as an example in [<a href="../references/#zhang2021">3</a>]. We conclude the assumptions in the below list:</p><ul><li>The function <span>$q(x_{1}, x_{2}) = 1$</span> is a constant function.</li><li>Neumann boundary condition on <span>$\partial \Omega$</span>.</li></ul><h2 id="Code"><a class="docs-heading-anchor" href="#Code">Code</a><a id="Code-1"></a><a class="docs-heading-anchor-permalink" href="#Code" title="Permalink"></a></h2><p>First we should load ClosedWaveguideDispersion.jl for implemented functions. We also need Ferrite.jl to define the interpolation.</p><pre><code class="language-julia hljs">using ClosedWaveguideDispersion
using Ferrite: Lagrange, RefTriangle</code></pre><p>Since we consider the homogeneous waveguide, we need to define the refraction index.</p><pre><code class="language-julia hljs"># Refractive index
function n(x)
   return 1.0
end;

# Period of the waveguide
p = 1.0;
# Height of the waveguide
h = 1.0;
# Number of points in the discrete Brillouin zone
N = 100;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100</code></pre><p>We use <a href="../api/#ClosedWaveguideDispersion.setup_grid-Tuple{}"><code>setup_grid</code></a> to generate mesh for the periodic cell with period <code>p</code> and height <code>h</code>.</p><pre><code class="language-julia hljs"># Set up the grid
grid = setup_grid(lc=0.05, period=p, height=h)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Ferrite.Grid{2, Ferrite.Triangle, Float64} with 944 Ferrite.Triangle cells and 513 nodes</code></pre><p>Then we need to define the interpolation, <code>CellValues</code> and <code>DofHandler</code> which are needed by Ferrite.jl.</p><pre><code class="language-julia hljs"># Define the interpolation
ip = Lagrange{RefTriangle, 1}()

# Set up the FE values: CellValues
cv = setup_fevs(ip)

# Set up the DofHandler
dh = setup_dofs(grid, ip);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Ferrite.DofHandler{2, Ferrite.Grid{2, Ferrite.Triangle, Float64}}
  Fields:
    :u, Ferrite.Lagrange{Ferrite.RefTriangle, 1}()
  Dofs per cell: 3
  Total dofs: 513</code></pre><p>In this example, the Neumann boundary condition is satisfied naturally. So we only need to impose the periodic boundary condition in <a href="../api/#ClosedWaveguideDispersion.setup_bdcs-Tuple{Ferrite.DofHandler}"><code>setup_bdcs</code></a>.</p><pre><code class="language-julia hljs"># Set the boundary conditions
cst = setup_bdcs(dh, period=p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintHandler:
  BCs:</code></pre><p>Now we should prepare for the assembly of the eigenvalue problem.</p><pre><code class="language-julia hljs"># Allocate the matrices
A = allocate_matries(dh, cst)
B = allocate_matries(dh, cst)

# Discretize the Brillouin zone
bz = collect(range(-π/p, π/p, N))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Float64}:
 -3.141592653589793
 -3.0781261353354537
 -3.0146596170811146
 -2.951193098826775
 -2.887726580572436
 -2.8242600623180967
 -2.7607935440637577
 -2.697327025809418
 -2.633860507555079
 -2.5703939893007397
  ⋮
  2.633860507555079
  2.697327025809418
  2.7607935440637577
  2.8242600623180967
  2.887726580572436
  2.951193098826775
  3.0146596170811146
  3.0781261353354537
  3.141592653589793</code></pre><p>In <a href="../api/#ClosedWaveguideDispersion.calc_diagram-Tuple{Ferrite.CellValues, Ferrite.DofHandler, Ferrite.ConstraintHandler, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Function, Any}"><code>calc_diagram</code></a>, <code>B</code> is generated only one time and <code>A</code> is generated with respect to <span>$\alpha$</span> in <code>bz</code>. Then we solve the generalized linear eigenvalue problem <span>$Ax = \mu Bx$</span> at each <span>$\alpha$</span>.</p><pre><code class="language-julia hljs"># Calculate the dispersion diagram
μ = calc_diagram(cv, dh, cst, A, B, n, bz, nevs=7)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100×7 Matrix{Float64}:
 9.86864  10.1161  19.7522  20.1265  49.5831  50.343   89.0705
 9.47394  10.5189  19.3575  20.5293  49.1884  50.7458  87.8782
 9.08729  10.9297  18.9709  20.9402  48.8018  51.1567  86.6941
 8.70869  11.3487  18.5923  21.3592  48.4233  51.5756  85.518
 8.33815  11.7757  18.2218  21.7862  48.0527  52.0025  84.3499
 7.97567  12.2107  17.8594  22.2212  47.6903  52.4376  83.1899
 7.62124  12.6538  17.505   22.6644  47.3359  52.8806  82.038
 7.27487  13.1049  17.1586  23.1155  46.9896  53.3318  80.8941
 6.93655  13.5641  16.8203  23.5748  46.6513  53.7909  79.7582
 6.60628  14.0314  16.4901  24.042   46.321   54.2582  78.6305
 ⋮                                             ⋮       
 6.93655  13.5641  16.8203  23.5748  46.6513  53.7909  79.7582
 7.27487  13.1049  17.1586  23.1155  46.9896  53.3318  80.8941
 7.62124  12.6538  17.505   22.6644  47.3359  52.8806  82.038
 7.97567  12.2107  17.8594  22.2212  47.6903  52.4376  83.1899
 8.33815  11.7757  18.2218  21.7862  48.0527  52.0025  84.3499
 8.70869  11.3487  18.5923  21.3592  48.4233  51.5756  85.518
 9.08729  10.9297  18.9709  20.9402  48.8018  51.1567  86.6941
 9.47394  10.5189  19.3575  20.5293  49.1884  50.7458  87.8782
 9.86864  10.1161  19.7522  20.1265  49.5831  50.343   89.0705</code></pre><p>Finally, we can plot our dispersion diagram.:</p><pre><code class="language-julia hljs"># Plot the dispersion diagram
plot_diagram(bz, μ, period=p)</code></pre><img src="ac147114.png" alt="Example block output"/><h2 id="Plain-code"><a class="docs-heading-anchor" href="#Plain-code">Plain code</a><a id="Plain-code-1"></a><a class="docs-heading-anchor-permalink" href="#Plain-code" title="Permalink"></a></h2><pre><code class="language-julia hljs">using ClosedWaveguideDispersion
using Ferrite: Lagrange, RefTriangle

# Parameters
function n(x)
   return 1.0 
end

p = 1.0
h = 1.0
N = 100

# Set up the grid 
grid = setup_grid(lc=0.05, period=p, height=h)

# Define the interpolation 
ip = Lagrange{RefTriangle, 1}()

# Set up the FE values: CellValues 
cv = setup_fevs(ip)

# Set up the DofHandler 
dh = setup_dofs(grid, ip)

# Set the boundary conditions
cst = setup_bdcs(dh, period=p)

# Allocate the matrices
A = allocate_matries(dh, cst)
B = allocate_matries(dh, cst)

# Discretize the Brillouin zone
bz = collect(range(-π/p, π/p, N))

# Calculate the dispersion diagram
μ = calc_diagram(cv, dh, cst, A, B, n, bz, nevs=7)

# Plot the dispersion diagram
plot_diagram(bz, μ, period=p)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../dirichlet/">Homogeneous case with Dirichelt boundary condition »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Monday 16 June 2025 14:01">Monday 16 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
